<h3>Практическая работа № 1.</h3>

# Консольные утилиты настройки сетевых компонентов в ОС Windows.

* __Цель работы:__   
Получить практические навыки по конфигурированию сети в операционных системах Microsoft Windows, ознакомится с утилитами командной строки, предназначенными для диагностики и настройки сети,  разработать исполняемые файлы, конфигурирующие сетевой интерфейс по заданным параметрам, ознакомиться с форматом записи пути до сетевого ресурса UNC.   
* __Требования:__  
Для выполнения работы необходима установленная ОС Windows 10 или Windows Server.  В случае если установленная на ПК операционная систем отличается от Windows, необходимо поставить виртуальную машину ORACLE Virtual Box.

* __Краткие теоретические сведения:__
В MS Windows к этим утилитам относят:  
•	Ipconfig – утилита отображения конфигурации IP,  
•	Ping – утилита диагностики сетевого соединения,  
•	Net – комплекс утилит для работы с сетью Microsoft,   
•	Netsh – утилита настройки всего стека протоколов MS Windows.
 
Справку по утилитам командной строки можно получить так: 
```command_name /?``` ,  
а по команде net так:  
```net help имя_директивы```

Управление сетевыми устройствами в ОС Windows реализовано и через PowerShell – актуальное, расширяемое средство автоматизации от Microsoft с открытым исходным кодом, состоящее из оболочки с интерфейсом командной строки и сопутствующего языка сценариев.
PowerShell доступен как в операционных системах серверного класса (например, Windows Server) так и на настольных операционных системах (например, Windows 10). Несмотря на то, что синтаксис и основные концепции PowerShell остаются похожими, есть некоторые различия между их версиями в Windows Server и Windows 10:

1. Модули и функции: PowerShell предоставляет различные модули и функции для управления различными аспектами операционной системы и приложений. В Windows Server могут быть доступны дополнительные модули и функции, специфические для серверных функций, таких как управление службами, доменными службами Active Directory, гипервизорами и т.д. В Windows 10 набор модулей и функций может быть более ограничен.

2. Уровни безопасности: В Windows Server существует более строгий контроль над разрешениями и безопасностью. PowerShell может использоваться для автоматизации административных задач, и в серверной среде это может подразумевать более жесткий контроль над тем, кто и как использует PowerShell.

3. Функциональность серверных ролей: Windows Server обычно используется для выполнения различных серверных ролей, таких как файловые серверы, веб-серверы, контроллеры домена и т.д. В связи с этим, PowerShell в Windows Server может иметь больше функциональности для управления этими серверными ролями.

4. Управление ресурсами: В Windows Server управление ресурсами, такими как диски, сетевые адаптеры, память и др., может иметь более расширенные возможности из-за потребностей серверной инфраструктуры.

5. Версии PowerShell: В Windows Server и Windows 10 могут быть установлены разные версии PowerShell. Новые версии могут включать в себя дополнительные функции, улучшения производительности и исправления ошибок, поэтому рекомендуется обращаться к официальной документации Microsoft для получения актуальной информации.

Предусмотрены следующие расширения для файлов PowerShell:
***.ps1 - файлы скриптов,  
* .psd1 - файлы данных скриптов,  
* .psm1 - файлы модулей скриптов,  
* .ps1xml - файлы конфигурации.** 
С ОС поставляется интегрированная среда сценариев Windows Powershell ISE – облегченная IDE для PowerShell. Для разработки подходит MS Visual Studio Code.

Вместо утилит используются командлеты – команды PowerShell с объектным интерфейсом.

Для управления сетевым соединением, среди прочих, используются командлеты: 
**
* Get-NetIPConfiguration, 
* New-NetIPAddress,  
* Set-NetIPAddress,  
* Get-NetRoute,  
* New-NetRoute,  
* Get-NetAdapterBinding,  
* Set-DnsClientServerAddress.**

Справку можно получить через *командлет*  
* Get-Help (например ```Get-Help New-NetRoute -Detailed```).

Список всех командлетов через *командлет*  
* Get-Command (```например Get-Command  -Noun NetAdapter или Get-Command -Name *Help*```).

**Ход работы**
# Проверить, активны ли следующие пункты в свойствах используемого сетевого подключения.
1. Клиент для сетей Microsoft (Клиент для сетей Microsoft - это компонент операционной системы Windows, предназначенный для обеспечения поддержки сетевых протоколов и функциональности, связанных с сетевыми соединениями. позволяет вашему компьютеру подключаться к другим компьютерам и сетевым ресурсам в локальной сети).  

3. Служба доступа к файлам и принтерам Microsoft.
* Служба доступа к файлам и принтерам Microsoft обеспечивает возможность общего доступа к файлам и принтерам в локальной сети, используя протокол SMB (Server Message Block). Это позволяет пользователям в сети просматривать, открывать и передавать файлы, а также печатать на общих сетевых принтерах.  

3. Протокол TCP/IP
* Протокол TCP/IP является основным протоколом для обмена данными в сети. Он обеспечивает адресацию и маршрутизацию данных между устройствами в сети, а также обеспечивает интернет-соединение.

  <img src="https://github.com/DeFomin/2023-2024-computer-networks-k33212-fomintsev-d-r/assets/90705279/5f709a9d-479b-4a55-9dd5-a88d1c7b94c7" width=300>
  
# Настроить сетевой интерфейс таким образом, чтобы внешние пользователи не могли получить доступ к ресурсам компьютера по протоколу SMB.
1. Отключение SMB на сетевом адаптере. Снимаем галочку с компонента клиент для сетей Microsoft. Это временно отключит протокол SMB.  
SMB чаще всего использует TCP для установления соединений, предоставления надежности и гарантии доставки данных. Обычно, **SMB работает на порту TCP 445 поверх него**
<div>
 <img align="left" src="https://github.com/DeFomin/2023-2024-computer-networks-k33212-fomintsev-d-r/assets/90705279/d16f479a-e39c-4109-b3ae-b6a3d1ac48ef" width=400>  

 <img src="https://github.com/DeFomin/2023-2024-computer-networks-k33212-fomintsev-d-r/assets/90705279/08ea8427-bafd-44cb-9c05-edb955736080" width=360>  
</div>

С помощью Брандмауэра создаем правило блокировки данного порта. 

<img src="https://github.com/DeFomin/2023-2024-computer-networks-k33212-fomintsev-d-r/assets/90705279/f01ef755-031f-4d67-87a5-9dba8deb184f" width=400>  

* Определение состояния, включение и отключение протоколов SMB <a href="https://learn.microsoft.com/ru-ru/windows-server/storage/file-server/troubleshoot/detect-enable-and-disable-smbv1-v2-v3?tabs=server">Windows Help</a>
> Семейство протоколов SMB включает в себя разные версии, включая SMBv1, SMBv2, SMBv3 и тд.
* SMBv1  
```Get-SmbServerConfiguration | Select EnableSMB1Protocol``` - Обнаружить  
```Set-SmbServerConfiguration -EnableSMB1Protocol $false``` - Выключить  
```Set-SmbServerConfiguration -EnableSMB1Protocol $true``` - Включить  
* SMB версии 2/v3  
```Get-SmbServerConfiguration | Select EnableSMB2Protocol``` - Обнаружить  
```Set-SmbServerConfiguration -EnableSMB2Protocol $false``` - Выключить  
```Set-SmbServerConfiguration -EnableSMB2Protocol $true``` - Включить  

# Команда ping в операционной системе Windows - это мощный инструмент для диагностики и проверки сети.
a. Проверка доступности удаленного хоста:
```
PS C:\Windows\system32> ping 8.8.8.8
Обмен пакетами с 8.8.8.8 по с 32 байтами данных:
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=14мс TTL=107

Статистика Ping для 8.8.8.8:
    Пакетов: отправлено = 4, получено = 4, потеряно = 0
    (0% потерь)
Приблизительное время приема-передачи в мс:
    Минимальное = 14мсек, Максимальное = 15 мсек, Среднее = 14 мсек
```

Команда ping отправляет ICMP-запросы этому хосту и выводит результаты, включая время задержки (ping) в миллисекундах.
> ICMP (Internet Control Message Protocol) - это протокол в сетях TCP/IP, используемый для отправки сообщений об ошибках и контроля состояния сети. ICMP-запросы и ICMP-ответы являются частью протокола ICMP и используются для обмена информацией между устройствами в сети. Одним из наиболее известных и часто используемых типов ICMP-сообщений являются "ICMP Echo Request" (запрос на эхо) и "ICMP Echo Reply" (ответ на эхо)

b. Запуск бесконечной проверки доступности:
```
PS C:\Windows\system32> ping -t 8.8.8.8

Обмен пакетами с 8.8.8.8 по с 32 байтами данных:
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=14мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=13мс TTL=107

Статистика Ping для 8.8.8.8:
    Пакетов: отправлено = 9, получено = 9, потеряно = 0
    (0% потерь)
Приблизительное время приема-передачи в мс:
    Минимальное = 13мсек, Максимальное = 15 мсек, Среднее = 14 мсек
Control-C
```

c. Ограничение числа запросов:
```
PS C:\Windows\system32> ping -n 1 8.8.8.8

Обмен пакетами с 8.8.8.8 по с 32 байтами данных:
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107

Статистика Ping для 8.8.8.8:
    Пакетов: отправлено = 1, получено = 1, потеряно = 0
    (0% потерь)
Приблизительное время приема-передачи в мс:
    Минимальное = 15мсек, Максимальное = 15 мсек, Среднее = 15 мсек
```

d. Изменение размера пакетов:
```
PS C:\Windows\system32> ping -l 512 1 google.com

Обмен пакетами с google.com [74.125.131.100] с 512 байтами данных:
Ответ от 74.125.131.100: число байт=68 (отправка 512) время=6мс TTL=110
Ответ от 74.125.131.100: число байт=68 (отправка 512) время=8мс TTL=110
Ответ от 74.125.131.100: число байт=68 (отправка 512) время=8мс TTL=110
Ответ от 74.125.131.100: число байт=68 (отправка 512) время=8мс TTL=110

Статистика Ping для 74.125.131.100:
    Пакетов: отправлено = 4, получено = 4, потеряно = 0
    (0% потерь)
Приблизительное время приема-передачи в мс:
    Минимальное = 6мсек, Максимальное = 8 мсек, Среднее = 7 мсек
```
Здесь IP-адрес 74.125.131.100 принадлежит серверу, который принимает запросы на имя домена google.com.


e. Определение маршрута к хосту:
```
PS C:\Windows\system32> tracert yandex.ru

Трассировка маршрута к yandex.ru [5.255.255.70]
с максимальным числом прыжков 30:

  1     2 ms     1 ms     1 ms  192.168.*.* - Запрос отправлялся с основного шлюза
  2    22 ms    18 ms    17 ms  10.49.5.233
  3     2 ms     2 ms     2 ms  110.188.192.91.static.------.-- [91.192.188.110]
  4     5 ms     3 ms     2 ms  bgp2.-------.-- [91.215.123.162]
  5     *        *        *     Превышен интервал ожидания для запроса.
  6     *        *        *     Превышен интервал ожидания для запроса.
  7    15 ms    13 ms    14 ms  yandex.ru [5.255.255.70]

Трассировка завершена.
```
f. Сохранение результатов в файл:
```
ping -n 5 google.com > D:\ITMO\3_course\5_semestr\ping.txt
```
<img src="https://github.com/DeFomin/2023-2024-computer-networks-k33212-fomintsev-d-r/assets/90705279/be93390a-f9a9-4c0d-a4ae-1c56d4abcb0d" width=300>

# Разобраться в назначении параметров и ключей утилиты tracert.  
_Команда tracert в операционной системе Windows используется для отслеживания маршрута, который сетевой пакет проходит от вашего компьютера к удаленному хосту._

a. Отслеживание маршрута к удаленному хосту:  
_4 пункт; задание "e"_

b. Изменение максимального количества прыжков (хопов):  
В 4 пункте, задания "e" выяснили что до yandex.ru 7 хопов, поэтому при  ```-h 4``` yandex.ru достигнут не был (по умолчанию количество прыжков 30)
```
PS C:\Windows\system32> tracert -h 4 yandex.ru

Трассировка маршрута к yandex.ru [5.255.255.70]
с максимальным числом прыжков 4:

  1     4 ms     2 ms     2 ms  192.168.*.*
  2    23 ms    20 ms    15 ms  10.49.5.233
  3     4 ms     4 ms     4 ms  110.188.192.91.static.-----.-- [91.192.188.110]
  4     3 ms     2 ms     2 ms  bgp2.-----.-- [91.215.123.162]

Трассировка завершена.
```

c. Изменение времени ожидания для каждого хопа:
К сожалению, увеличив время ожидания до 100000 5 и 6 хоп не появился
```
PS C:\Windows\system32> tracert -w 100000 yandex.ru

Трассировка маршрута к yandex.ru [5.255.255.77]
с максимальным числом прыжков 30:

  1     3 ms     1 ms     1 ms  192.168.*.*
  2    17 ms    21 ms    17 ms  10.49.5.233
  3     2 ms     3 ms     2 ms  110.188.192.91.static.----.-- [91.192.188.110]
  4     7 ms     4 ms     5 ms  bgp2.----.-- [91.215.123.162]
  5     *        *        *     Превышен интервал ожидания для запроса.
  6     *        *        *     Превышен интервал ожидания для запроса.
  7    16 ms    14 ms    15 ms  yandex.ru [5.255.255.77]

Трассировка завершена.
```
# Утилита ipconfig  
ipconfig - это утилита в операционной системе Windows, которая предоставляет информацию о настройках сетевых адаптеров на вашем компьютере. Она полезна для получения информации о вашем IP-адресе, маске подсети, шлюзе по умолчанию и других сетевых параметрах.

a. Получение информации о сетевых адаптерах.
Команда ipconfig используется для отображения текущих настроек протокола TCP/IP и для обновления некоторых параметров, задаваемых при автоматическом конфигурировании сетевых интерфейсов при использовании протокола Dynamic Host Configuration Protocol (DHCP)

```
PS C:\Windows\system32> ipconfig

Настройка протокола IP для Windows


Адаптер Ethernet Ethernet 2:

   DNS-суффикс подключения . . . . . :
   Локальный IPv6-адрес канала . . . : fe80::cdd4:******:******:******
   IPv4-адрес. . . . . . . . . . . . : 192.168.*.*
   Маска подсети . . . . . . . . . . : 255.255.*.*
   Основной шлюз. . . . . . . . . :

Адаптер беспроводной локальной сети Подключение по локальной сети* 1:

   Состояние среды. . . . . . . . : Среда передачи недоступна.
   DNS-суффикс подключения . . . . . :

Адаптер беспроводной локальной сети Подключение по локальной сети* 2:

   Состояние среды. . . . . . . . : Среда передачи недоступна.
   DNS-суффикс подключения . . . . . :

Адаптер беспроводной локальной сети Беспроводная сеть:

   DNS-суффикс подключения . . . . . :
   IPv4-адрес. . . . . . . . . . . . : 192.168.*.*
   Маска подсети . . . . . . . . . . : 255.255.*.*
   Основной шлюз. . . . . . . . . : 192.168.*.*

Адаптер Ethernet Сетевое подключение Bluetooth:

   Состояние среды. . . . . . . . : Среда передачи недоступна.
   DNS-суффикс подключения . . . . . :
```

b. ipconfig /all
Этот параметр выводит подробную информацию о сетевых настройках, включая IP-адрес, маску подсети, шлюз по умолчанию, DNS-серверы и многое другое.

c. ipconfig /release и ipconfig /renew
Эти параметры используются для освобождения и обновления IP-адреса компьютера, соответственно.

d. ipconfig /flushdns
Этот параметр очищает кеш DNS на вашем компьютере.

e. ipconfig /displaydns
Этот параметр выводит содержимое кеша DNS на вашем компьютере

f. upconfig /flushdns
Очистка кэша сопоставителя DNS.

# Утилита net
Широкий набор команд для управления различными аспектами сетевых служб и ресурсов.

a. Просмотр информации о текущем пользователе
```
PS C:\Windows\system32> net user
>>

Учетные записи пользователей для \\CLEVER

-------------------------------------------------------------------------------
DefaultAccount           fomid                    WDAGUtilityAccount
Администратор            Гость
Команда выполнена успешно.
```

b. Просмотр списка групп
```
PS C:\Windows\system32> net localgroup
>>

Псевдонимы для \\CLEVER

-------------------------------------------------------------------------------
*Hyper-V Administrators
*IIS_IUSRS
*Администраторы
*Владельцы устройства
*Гости
*Пользователи
*Пользователи DCOM
*Пользователи журналов производительности
*Пользователи системного монитора
*Пользователи удаленного управления
*Управляемая системой группа учетных записей
*Читатели журнала событий
Команда выполнена успешно.
```

c. Просмотр информации о конкретном пользователе
```
PS C:\Windows\system32> net user fomid
Имя пользователя                       fomid
Полное имя                             Denis Fomintsev
Комментарий
Комментарий пользователя
Код страны или региона                 000 (Стандартный системный)
Учетная запись активна                 Yes
Учетная запись просрочена              Никогда

Последний пароль задан                 03.07.2023 19:40:01
Действие пароля завершается            Никогда
Пароль допускает изменение             03.07.2023 19:40:01
Требуется пароль                       Yes
Пользователь может изменить пароль     Yes

Разрешенные рабочие станции            Все
Сценарий входа
Конфигурация пользователя
Основной каталог
Последний вход                         Никогда

Разрешенные часы входа                 Все

Членство в локальных группах           *Администраторы
                                       *Пользователи
Членство в глобальных группах          *Отсутствует
Команда выполнена успешно.
```

d. Создание нового пользователя
```

```

