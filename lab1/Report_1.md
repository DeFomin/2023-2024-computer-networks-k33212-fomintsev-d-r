<h3>Практическая работа № 1.</h3>

## Оглавление  
- [Консольные утилиты настройки сетевых компонентов в ОС Windows.](#section1)
  - [Цель работы](#section1.1)
  - [Требования](#section1.2)
  - [Краткие теоретические сведения](#section1.3)
- [Ход работы](#section2)
  - [Клиент для сетей Microsoft/Служба доступа к файлам и принтерам Microsoft/Протокол TCP/IP](#section2.1)
  - [Отключение протокола SMB](#section2.2)
  - [Команда ping](#section2.3)
  - [Утилита tracert](#section2.4)
  - [Утилита ipconfig](#section2.5)
  - [Утилита net](#section2.6)
  - [Командный файл netsh (batch)](#section2.7)
  - [Командный файл powershell](#section2.8)
- [Вопросы и задания](#section3)
  
## <a name="section1">Консольные утилиты настройки сетевых компонентов в ОС Windows.</a>

### <a name="section1.1">Цель работы</a>  
Получить практические навыки по конфигурированию сети в операционных системах Microsoft Windows, ознакомится с утилитами командной строки, предназначенными для диагностики и настройки сети,  разработать исполняемые файлы, конфигурирующие сетевой интерфейс по заданным параметрам, ознакомиться с форматом записи пути до сетевого ресурса UNC.   
### <a name="section1.2">Требования</a>  
Для выполнения работы необходима установленная ОС Windows 10 или Windows Server.  В случае если установленная на ПК операционная систем отличается от Windows, необходимо поставить виртуальную машину ORACLE Virtual Box.

### <a name="section1.3">Краткие теоретические сведения</a> 
В MS Windows к этим утилитам относят:  
•	Ipconfig – утилита отображения конфигурации IP,  
•	Ping – утилита диагностики сетевого соединения,  
•	Net – комплекс утилит для работы с сетью Microsoft,   
•	Netsh – утилита настройки всего стека протоколов MS Windows.
 
Справку по утилитам командной строки можно получить так: 
```command_name /?``` ,  
а по команде net так:  
```net help имя_директивы```

Управление сетевыми устройствами в ОС Windows реализовано и через PowerShell – актуальное, расширяемое средство автоматизации от Microsoft с открытым исходным кодом, состоящее из оболочки с интерфейсом командной строки и сопутствующего языка сценариев.
PowerShell доступен как в операционных системах серверного класса (например, Windows Server) так и на настольных операционных системах (например, Windows 10). Несмотря на то, что синтаксис и основные концепции PowerShell остаются похожими, есть некоторые различия между их версиями в Windows Server и Windows 10:

1. Модули и функции: PowerShell предоставляет различные модули и функции для управления различными аспектами операционной системы и приложений. В Windows Server могут быть доступны дополнительные модули и функции, специфические для серверных функций, таких как управление службами, доменными службами Active Directory, гипервизорами и т.д. В Windows 10 набор модулей и функций может быть более ограничен.

2. Уровни безопасности: В Windows Server существует более строгий контроль над разрешениями и безопасностью. PowerShell может использоваться для автоматизации административных задач, и в серверной среде это может подразумевать более жесткий контроль над тем, кто и как использует PowerShell.

3. Функциональность серверных ролей: Windows Server обычно используется для выполнения различных серверных ролей, таких как файловые серверы, веб-серверы, контроллеры домена и т.д. В связи с этим, PowerShell в Windows Server может иметь больше функциональности для управления этими серверными ролями.

4. Управление ресурсами: В Windows Server управление ресурсами, такими как диски, сетевые адаптеры, память и др., может иметь более расширенные возможности из-за потребностей серверной инфраструктуры.

5. Версии PowerShell: В Windows Server и Windows 10 могут быть установлены разные версии PowerShell. Новые версии могут включать в себя дополнительные функции, улучшения производительности и исправления ошибок, поэтому рекомендуется обращаться к официальной документации Microsoft для получения актуальной информации.

Предусмотрены следующие расширения для файлов PowerShell:
***.ps1 - файлы скриптов,  
* .psd1 - файлы данных скриптов,  
* .psm1 - файлы модулей скриптов,  
* .ps1xml - файлы конфигурации.** 
С ОС поставляется интегрированная среда сценариев Windows Powershell ISE – облегченная IDE для PowerShell. Для разработки подходит MS Visual Studio Code.

Вместо утилит используются командлеты – команды PowerShell с объектным интерфейсом.

Для управления сетевым соединением, среди прочих, используются командлеты: 
**
* Get-NetIPConfiguration, 
* New-NetIPAddress,  
* Set-NetIPAddress,  
* Get-NetRoute,  
* New-NetRoute,  
* Get-NetAdapterBinding,  
* Set-DnsClientServerAddress.**

Справку можно получить через *командлет*  
* Get-Help (например ```Get-Help New-NetRoute -Detailed```).

Список всех командлетов через *командлет*  
* Get-Command (```например Get-Command  -Noun NetAdapter или Get-Command -Name *Help*```).

## <a name="section2">Ход работы</a>
### <a name="section2.1">Клиент для сетей Microsoft/Служба доступа к файлам и принтерам Microsoft/Протокол TCP/IP</a>

1. Клиент для сетей Microsoft (Клиент для сетей Microsoft - это компонент операционной системы Windows, предназначенный для обеспечения поддержки сетевых протоколов и функциональности, связанных с сетевыми соединениями. позволяет вашему компьютеру подключаться к другим компьютерам и сетевым ресурсам в локальной сети).  

3. Служба доступа к файлам и принтерам Microsoft.
* Служба доступа к файлам и принтерам Microsoft обеспечивает возможность общего доступа к файлам и принтерам в локальной сети, используя протокол SMB (Server Message Block). Это позволяет пользователям в сети просматривать, открывать и передавать файлы, а также печатать на общих сетевых принтерах.  

3. Протокол TCP/IP
* Протокол TCP/IP является основным протоколом для обмена данными в сети. Он обеспечивает адресацию и маршрутизацию данных между устройствами в сети, а также обеспечивает интернет-соединение.

  <img src="https://github.com/DeFomin/2023-2024-computer-networks-k33212-fomintsev-d-r/assets/90705279/5f709a9d-479b-4a55-9dd5-a88d1c7b94c7" width=300>
  
### <a name="section2.2">Отключение протокола SMB</a>
Настроить сетевой интерфейс таким образом, чтобы внешние пользователи не могли получить доступ к ресурсам компьютера по протоколу SMB.

1. Отключение SMB на сетевом адаптере. Снимаем галочку с компонента клиент для сетей Microsoft, протокола TCP/IP, службы доступа к файлам и принтерам Microsoft.
<img src="https://github.com/DeFomin/2023-2024-computer-networks-k33212-fomintsev-d-r/assets/90705279/f1b4e108-f02c-4bd5-96cc-ee6c3c875085" width=400>

SMB чаще всего использует TCP для установления соединений, предоставления надежности и гарантии доставки данных. Обычно, **SMB работает на порту TCP 445 поверх него**
<div>
 <img align="left" src="https://github.com/DeFomin/2023-2024-computer-networks-k33212-fomintsev-d-r/assets/90705279/d16f479a-e39c-4109-b3ae-b6a3d1ac48ef" width=400>  

 <img src="https://github.com/DeFomin/2023-2024-computer-networks-k33212-fomintsev-d-r/assets/90705279/08ea8427-bafd-44cb-9c05-edb955736080" width=360>  
</div>

С помощью Брандмауэра создаем правило блокировки данного порта. 

<img src="https://github.com/DeFomin/2023-2024-computer-networks-k33212-fomintsev-d-r/assets/90705279/f01ef755-031f-4d67-87a5-9dba8deb184f" width=400>  

* Определение состояния, включение и отключение протоколов SMB <a href="https://learn.microsoft.com/ru-ru/windows-server/storage/file-server/troubleshoot/detect-enable-and-disable-smbv1-v2-v3?tabs=server">Windows Help</a>
> Семейство протоколов SMB включает в себя разные версии, включая SMBv1, SMBv2, SMBv3 и тд.
* SMBv1  
```Get-SmbServerConfiguration | Select EnableSMB1Protocol``` - Обнаружить  
```Set-SmbServerConfiguration -EnableSMB1Protocol $false``` - Выключить  
```Set-SmbServerConfiguration -EnableSMB1Protocol $true``` - Включить  
* SMB версии 2/v3  
```Get-SmbServerConfiguration | Select EnableSMB2Protocol``` - Обнаружить  
```Set-SmbServerConfiguration -EnableSMB2Protocol $false``` - Выключить  
```Set-SmbServerConfiguration -EnableSMB2Protocol $true``` - Включить  

### <a name="section2.3">Команда ping</a>
В операционной системе Windows - это мощный инструмент для диагностики и проверки сети.
a. Проверка доступности удаленного хоста:
```powershell
PS C:\Windows\system32> ping 8.8.8.8
Обмен пакетами с 8.8.8.8 по с 32 байтами данных:
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=14мс TTL=107

Статистика Ping для 8.8.8.8:
    Пакетов: отправлено = 4, получено = 4, потеряно = 0
    (0% потерь)
Приблизительное время приема-передачи в мс:
    Минимальное = 14мсек, Максимальное = 15 мсек, Среднее = 14 мсек
```

Команда ping отправляет ICMP-запросы этому хосту и выводит результаты, включая время задержки (ping) в миллисекундах.
> ICMP (Internet Control Message Protocol) - это протокол в сетях TCP/IP, используемый для отправки сообщений об ошибках и контроля состояния сети. ICMP-запросы и ICMP-ответы являются частью протокола ICMP и используются для обмена информацией между устройствами в сети. Одним из наиболее известных и часто используемых типов ICMP-сообщений являются "ICMP Echo Request" (запрос на эхо) и "ICMP Echo Reply" (ответ на эхо)

b. Запуск бесконечной проверки доступности:
```powershell
PS C:\Windows\system32> ping -t 8.8.8.8

Обмен пакетами с 8.8.8.8 по с 32 байтами данных:
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=14мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107
Ответ от 8.8.8.8: число байт=32 время=13мс TTL=107

Статистика Ping для 8.8.8.8:
    Пакетов: отправлено = 9, получено = 9, потеряно = 0
    (0% потерь)
Приблизительное время приема-передачи в мс:
    Минимальное = 13мсек, Максимальное = 15 мсек, Среднее = 14 мсек
Control-C
```

c. Ограничение числа запросов:
```powershell
PS C:\Windows\system32> ping -n 1 8.8.8.8

Обмен пакетами с 8.8.8.8 по с 32 байтами данных:
Ответ от 8.8.8.8: число байт=32 время=15мс TTL=107

Статистика Ping для 8.8.8.8:
    Пакетов: отправлено = 1, получено = 1, потеряно = 0
    (0% потерь)
Приблизительное время приема-передачи в мс:
    Минимальное = 15мсек, Максимальное = 15 мсек, Среднее = 15 мсек
```

d. Изменение размера пакетов:
```powershell
PS C:\Windows\system32> ping -l 512 1 google.com

Обмен пакетами с google.com [74.125.131.100] с 512 байтами данных:
Ответ от 74.125.131.100: число байт=68 (отправка 512) время=6мс TTL=110
Ответ от 74.125.131.100: число байт=68 (отправка 512) время=8мс TTL=110
Ответ от 74.125.131.100: число байт=68 (отправка 512) время=8мс TTL=110
Ответ от 74.125.131.100: число байт=68 (отправка 512) время=8мс TTL=110

Статистика Ping для 74.125.131.100:
    Пакетов: отправлено = 4, получено = 4, потеряно = 0
    (0% потерь)
Приблизительное время приема-передачи в мс:
    Минимальное = 6мсек, Максимальное = 8 мсек, Среднее = 7 мсек
```
Здесь IP-адрес 74.125.131.100 принадлежит серверу, который принимает запросы на имя домена google.com.


e. Определение маршрута к хосту:
```powershell
PS C:\Windows\system32> tracert yandex.ru

Трассировка маршрута к yandex.ru [5.255.255.70]
с максимальным числом прыжков 30:

  1     2 ms     1 ms     1 ms  192.168.*.* - Запрос отправлялся с основного шлюза
  2    22 ms    18 ms    17 ms  10.49.5.233
  3     2 ms     2 ms     2 ms  110.188.192.91.static.------.-- [91.192.188.110]
  4     5 ms     3 ms     2 ms  bgp2.-------.-- [91.215.123.162]
  5     *        *        *     Превышен интервал ожидания для запроса.
  6     *        *        *     Превышен интервал ожидания для запроса.
  7    15 ms    13 ms    14 ms  yandex.ru [5.255.255.70]

Трассировка завершена.
```
f. Сохранение результатов в файл:
```powershell
ping -n 5 google.com > D:\ITMO\3_course\5_semestr\ping.txt
```
<img src="https://github.com/DeFomin/2023-2024-computer-networks-k33212-fomintsev-d-r/assets/90705279/be93390a-f9a9-4c0d-a4ae-1c56d4abcb0d" width=300>

### <a name="section2.4">Утилита tracert</a>
_Команда tracert в операционной системе Windows используется для отслеживания маршрута, который сетевой пакет проходит от вашего компьютера к удаленному хосту._

a. Отслеживание маршрута к удаленному хосту:  
_4 пункт; задание "e"_

b. Изменение максимального количества прыжков (хопов):  
В 4 пункте, задания "e" выяснили что до yandex.ru 7 хопов, поэтому при  ```-h 4``` yandex.ru достигнут не был (по умолчанию количество прыжков 30)
```powershell
PS C:\Windows\system32> tracert -h 4 yandex.ru

Трассировка маршрута к yandex.ru [5.255.255.70]
с максимальным числом прыжков 4:

  1     4 ms     2 ms     2 ms  192.168.*.*
  2    23 ms    20 ms    15 ms  10.49.5.233
  3     4 ms     4 ms     4 ms  110.188.192.91.static.-----.-- [91.192.188.110]
  4     3 ms     2 ms     2 ms  bgp2.-----.-- [91.215.123.162]

Трассировка завершена.
```

c. Изменение времени ожидания для каждого хопа:
К сожалению, увеличив время ожидания до 100000 5 и 6 хоп не появился
```powershell
PS C:\Windows\system32> tracert -w 100000 yandex.ru

Трассировка маршрута к yandex.ru [5.255.255.77]
с максимальным числом прыжков 30:

  1     3 ms     1 ms     1 ms  192.168.*.*
  2    17 ms    21 ms    17 ms  10.49.5.233
  3     2 ms     3 ms     2 ms  110.188.192.91.static.----.-- [91.192.188.110]
  4     7 ms     4 ms     5 ms  bgp2.----.-- [91.215.123.162]
  5     *        *        *     Превышен интервал ожидания для запроса.
  6     *        *        *     Превышен интервал ожидания для запроса.
  7    16 ms    14 ms    15 ms  yandex.ru [5.255.255.77]

Трассировка завершена.
```
### <a name="section2.5">Утилита ipconfig</a>    
ipconfig - это утилита в операционной системе Windows, которая предоставляет информацию о настройках сетевых адаптеров на вашем компьютере. Она полезна для получения информации о вашем IP-адресе, маске подсети, шлюзе по умолчанию и других сетевых параметрах.

a. Получение информации о сетевых адаптерах. ```ipconfig /all```
Этот параметр выводит подробную информацию о сетевых настройках, включая IP-адрес, маску подсети, шлюз по умолчанию, DNS-серверы и многое другое.

```powershell
PS C:\Windows\system32> ipconfig /all

Настройка протокола IP для Windows


Адаптер Ethernet Ethernet 2:

   DNS-суффикс подключения . . . . . :
   Локальный IPv6-адрес канала . . . : fe80::cdd4:******:******:******
   IPv4-адрес. . . . . . . . . . . . : 192.168.*.*
   Маска подсети . . . . . . . . . . : 255.255.*.*
   Основной шлюз. . . . . . . . . :

Адаптер беспроводной локальной сети Подключение по локальной сети* 1:

   Состояние среды. . . . . . . . : Среда передачи недоступна.
   DNS-суффикс подключения . . . . . :

Адаптер беспроводной локальной сети Подключение по локальной сети* 2:

   Состояние среды. . . . . . . . : Среда передачи недоступна.
   DNS-суффикс подключения . . . . . :

Адаптер беспроводной локальной сети Беспроводная сеть:

   DNS-суффикс подключения . . . . . :
   IPv4-адрес. . . . . . . . . . . . : 192.168.*.*
   Маска подсети . . . . . . . . . . : 255.255.*.*
   Основной шлюз. . . . . . . . . : 192.168.*.*

Адаптер Ethernet Сетевое подключение Bluetooth:

   Состояние среды. . . . . . . . : Среда передачи недоступна.
   DNS-суффикс подключения . . . . . :
```

b. ```ipconfig /release и ipconfig /renew```
Эти параметры используются для освобождения и обновления IP-адреса компьютера, соответственно.

c. ```ipconfig /flushdns```
Этот параметр очищает кеш DNS на вашем компьютере.
```powershell
PS C:\Windows\system32> ipconfig /flushdns

Настройка протокола IP для Windows

Кэш сопоставителя DNS успешно очищен.
```

d. ```ipconfig /registerdns```
Зарегистрирование и обновление записей DNS (Domain Name System) компьютера в DNS-сервере. 
```
PS C:\Windows\system32> ipconfig /registerdns

Настройка протокола IP для Windows

Начата регистрация записей ресурсов DNS для всех адаптеров этого компьютера. Отчет об ошибках будет выведен в окне "Просмотр событий" через 15 минут.
```

### <a name="section2.6">Утилита net</a>
Широкий набор команд для управления различными аспектами сетевых служб и ресурсов.

a. Просмотр запущенных служб
```powershell
net start
>>
Запущены следующие службы Windows:

   BcastDVRUserService_41849
   BluetoothUserService_41849
   CaptureService_41849
   cbdhsvc_41849
   CDPUserSvc_41849
   CoreMessaging
   DevicesFlowUserSvc_41849
   DHCP-клиент
   DNS-клиент
   Huawei APO service
   Huawei Connectivity Windows Service
   Huawei Distributed Windows Service
   Huawei LCD_Service
   Huawei PC Core Service
   Huawei PCManager Windows Service
   HW OSD Service
   Intel Analytics Service
   Intel Dynamic Bandwidth Management
   Intel(R) Audio Service
   Intel(R) Content Protection HDCP Service
   Intel(R) Dynamic Application Loader Host Interface Service
   Intel(R) Dynamic Tuning Technology Telemetry Service
   Intel(R) Graphics Command Center Service
   Intel(R) Innovation Platform Framework Service
   Intel(R) Management Engine WMI Provider Registration
   IntelConnect Service
   Intel® PROSet/Wireless Service
   Microsoft Office Click-to-Run Service
   NPSMSvc_41849
   OneSyncSvc_41849
   PimIndexMaintenanceSvc_41849
   Plug and Play
   SenaryAudioApp.Svc
   Session Detection
   SysMain
   UdkUserSvc_41849
   UnistoreSvc_41849
   UserDataSvc_41849
   Wacom Professional Service
   webthreatdefusersvc_41849
   Windows Audio
   Windows Search
   WpnUserService_41849
   WUCSProxy
   Xbox Accessory Management Service
   Брандмауэр Защитника Windows
   Брокер времени
   Брокер мониторинга среды выполнения System Guard
   Брокер системных событий
   Вспомогательная служба IP
   Вторичный вход в систему
   Диспетчер локальных сеансов
   Диспетчер печати
   Диспетчер подключений Windows
   Диспетчер подключений удаленного доступа
   Диспетчер пользователей
   Диспетчер учетных веб-записей
   Диспетчер учетных данных
   Диспетчер учетных записей безопасности
   Журнал событий Windows
   Изоляция ключей CNG
   Инструментарий управления Windows
   Использование данных
   Клиент групповой политики
   Клиент отслеживания изменившихся связей
   Контейнер службы Microsoft Passport
   Модуль запуска процессов DCOM-сервера
   Модуль поддержки NetBIOS через TCP/IP
   Обнаружение SSDP
   Определение оборудования оболочки
   Оптимизация доставки
   Питание
   Планировщик задач
   Помощник по входу в учетную запись Майкрософт
   Посредник подключений к сети
   Рабочая станция
   Сведения о приложении
   Сервер
   Сетевые подключения
   Система событий COM+
   Служба "Безопасность Windows"
   Служба AVCTP
   Служба Microsoft Passport
   Служба SSTP
   Служба Windows License Manager
   Служба автоматического обнаружения веб-прокси WinHTTP
   Служба автонастройки WLAN
   Служба антивирусной программы Microsoft Defender
   Служба базовой фильтрации
   Служба географического положения
   Служба диспетчера доступа к возможностям
   Служба диспетчера подключений служб Wi-Fi Direct
   Служба защиты от веб-угроз
   Служба звукового шлюза Bluetooth
   Служба интерфейса сохранения сети
   Служба инфраструктуры фоновых задач
   Служба кэша шрифтов Windows
   Служба оркестратора обновлений
   Служба платформы подключенных устройств
   Служба поддержки Bluetooth
   Служба политики диагностики
   Служба политики отображения
   Служба помощника по совместимости программ
   Служба проверки сети антивирусной программы Microsoft Defender
   Служба профилей пользователей
   Служба репозитория состояний
   Служба системы push-уведомлений Windows
   Служба совместного доступа к данным
   Служба сопоставления устройств
   Служба списка сетей
   Служба уведомления о системных событиях
   Служба улучшения отображения
   Служба управления радио
   Служба управления текстовым вводом
   Служба установки Microsoft Store
   Служба хранилища
   Службы криптографии
   Сопоставитель конечных точек RPC
   Средство построения конечных точек Windows Audio
   Телефонная связь
   Темы
   Удаленный вызов процедур (RPC)
   Узел службы диагностики
   Функциональные возможности для подключенных пользователей и телеметрия
   Центр обеспечения безопасности

Команда выполнена успешно.
```

b. Остановка службы
```powershell
PS C:\Windows\system32> NET STOP SPOOLER
Служба "Диспетчер печати" останавливается.
Служба "Диспетчер печати" успешно остановлена.
```

c. Запуск службы
```powershell
PS C:\Windows\system32> net start SPOOLER
Служба "Диспетчер печати" запускается.
Служба "Диспетчер печати" успешно запущена.
```

d. Отображение списка компьютеров
Отображает список доменов, компьютеров или ресурсов, которые используются указанным компьютером совместно. При использовании без параметров net view отображает список компьютеров в вашем текущем домене.
```powershell
PS C:\Windows\system32> net view
Имя сервера            Заметки

-------------------------------------------------------------------------------
\\CLEVER
Команда выполнена успешно.
```
e. Управление общими ресурсами (shared resources)
Управляет общими ресурсами. При использовании без параметров net share отображает информацию обо всех ресурсах, которые являются общими на локальном компьютере.
```powershell
PS C:\Windows\system32> net share

Имя общего ресурса   Ресурс                        Заметки

-------------------------------------------------------------------------------
C$           C:\                             Стандартный общий ресурс
D$           D:\                             Стандартный общий ресурс
IPC$                                         Удаленный IPC
ADMIN$       C:\Windows                      Удаленный Admin
Команда выполнена успешно.
```
f. Управление сетевой конфигурацией и сессиями
```powershell
PS C:\Windows\system32> net config
>>
Допускается управление следующими выполняющимися службами:

   Сервер
   Рабочая станция

Команда выполнена успешно.
```
g. Управление сетевой конфигурацией и сессиями
```powershell
PS C:\Windows\system32> net session
>>
В списке нет элементов.
```
k. Управление пользователями и группами
```powershell
PS C:\Windows\system32> net localgroup
>>

Псевдонимы для \\CLEVER

-------------------------------------------------------------------------------
*Hyper-V Administrators
*IIS_IUSRS
*Администраторы
*Владельцы устройства
*Гости
*Пользователи
*Пользователи DCOM
*Пользователи журналов производительности
*Пользователи системного монитора
*Пользователи удаленного управления
*Управляемая системой группа учетных записей
*Читатели журнала событий
Команда выполнена успешно.
```
```
PS C:\Windows\system32> net localgroup Администраторы
>>
Имя псевдонима     Администраторы
Комментарий        Администраторы имеют полные, ничем не ограниченные права доступа к компьютеру или домену

Члены

-------------------------------------------------------------------------------
fomid
Администратор
Команда выполнена успешно.
```
l. Добавить нового пользователя
```powershell
PS C:\Windows\system32> net localgroup testadmin /add
>>
Команда выполнена успешно.

PS C:\Windows\system32> net localgroup Администраторы testadmin /add
>>
Команда выполнена успешно.

```
Удалить пользователя
```powershell
net localgroup Администраторы testadmin /delete
```
m. Просмотр статистики сетевых интерфейсов
```powershell
PS C:\Windows\system32> net statistics workstation
>>
Статистика рабочей станции для \\CLEVER


Статистика после 18.09.2023 13:48:46


  Получено байт                              2394
  Принятые блоки сообщений сервера SMB       1
  Передано байт                              2022
  Переданные блоки сообщений сервера SMB     0
  Операции чтения                            0
  Операции записи                            0
  Отказано в чтении                          0
  Отказано в записи                          0

  Ошибки сети                                0
  Выполненные подключения                    0
  Повторные подключения                      0
  Отключений от сервера                      0

  Запущенные сеансы                          0
  Зависание сеансов                          0
  Сбои в сеансах                             0
  Сбои в операциях                           0
  Счетчик использования                      1
  Счетчик сбоев при использовании            0

Команда выполнена успешно.
```
n. Просмотр статистики сеансов
```powershell
PS C:\Windows\system32> NET STATISTICS WORKSTATION
Статистика рабочей станции для \\CLEVER


Статистика после 18.09.2023 13:48:46


  Получено байт                              2394
  Принятые блоки сообщений сервера SMB       2
  Передано байт                              2022
  Переданные блоки сообщений сервера SMB     0
  Операции чтения                            0
  Операции записи                            0
  Отказано в чтении                          0
  Отказано в записи                          0

  Ошибки сети                                0
  Выполненные подключения                    0
  Повторные подключения                      0
  Отключений от сервера                      0

  Запущенные сеансы                          0
  Зависание сеансов                          0
  Сбои в сеансах                             0
  Сбои в операциях                           0
  Счетчик использования                      1
  Счетчик сбоев при использовании            0

Команда выполнена успешно.
```
### <a name="section2.7">Командный файл netsh (batch)</a>
Для начала я сделал резервную копию
```netsh interface ipv4 dump > "D:\ITMO\3_course\5_semestr\backup.txt"```

После переименовал свой сетевой интерфейс ```Rename-NetAdapter -Name "Беспроводная сеть" -NewName "Wireless"```
Далее создаем файл с раширением .bat
```batch
@echo off
setlocal enabledelayedexpansion
set /p choice=Select configuration mode (1: DHCP, 2: Manual):
echo Available network connections
netsh interface show interface
set /p local=Enter your local area connection ("Wireless"):

if "%choice%"=="1" (
    echo You've choosen DHCP.
    netsh interface ip set addres %local% dhcp
    netsh interface ip set dns %local% dhcp
) else if "%choice%"=="2" (
    echo You've choosen Manual.

    set /p ip=Enter IP adress:
    set /p mask=Enter subnet mask:
    set /p gateway=Enter default gateway:
    set /p dns=Enter DNS server adress:

    netsh interface ip set address name=%local% static address="!ip!" mask="!mask!" gateway="!gateway!"
    netsh interface ip set dns name=%local% static "!dns!" validate=no
) else (
    echo Please select 1 or 2.
)
pause
```

Запускаем данный скрипт ```./batchcode.bat```, выбираем 2 режим и наш адаптер, вводим любые данные ip, mask, gateway, dns.
```powershell
PS D:\ITMO\3_course\5_semestr> ./batchcode.bat
Select configuration mode (1: DHCP, 2: Manual): 2
Available network connections

Состояние адм.  Состояние     Тип              Имя интерфейса
---------------------------------------------------------------------
Разрешен       Подключен      Выделенный       Wireless
Разрешен       Подключен      Выделенный       Ethernet 2

Enter your local area connection ("Wireless"): Wireless
You've choosen Manual.
Enter IP adress:192.168.1.100
Enter subnet mask:255.255.255.0
Enter default gateway:192.168.1.1
Enter DNS server adress:8.8.8.8
```

Проверяем через ipconfig
```powershell
Адаптер беспроводной локальной сети Wireless:

   DNS-суффикс подключения . . . . . :
   Описание. . . . . . . . . . . . . : Intel(R) Wi-Fi 6E AX211 160MHz
   Физический адрес. . . . . . . . . : 58-1C-F8-F0-4B-55
   DHCP включен. . . . . . . . . . . : Нет
   Автонастройка включена. . . . . . : Да
   IPv4-адрес. . . . . . . . . . . . : 192.168.1.100(Основной)
   Маска подсети . . . . . . . . . . : 255.255.255.0
   Основной шлюз. . . . . . . . . : 192.168.1.1
   DNS-серверы. . . . . . . . . . . : 8.8.8.8
   NetBios через TCP/IP. . . . . . . . : Включен
```

__При этом интернет пропадет__

Возвращаем интернет и правильные настройки через тот же скрипт, в данный раз выбираем 1 пункт через dhcp
```powershell
Адаптер беспроводной локальной сети Wireless:

   Состояние среды. . . . . . . . : Среда передачи недоступна.
   DNS-суффикс подключения . . . . . :
   Описание. . . . . . . . . . . . . : Intel(R) Wi-Fi 6E AX211 160MHz
   Физический адрес. . . . . . . . . : 58-1C-F8-F0-4B-55
   DHCP включен. . . . . . . . . . . : Да
   Автонастройка включена. . . . . . : Да
```

Через минуту появятся правильные настройки и интернет.

### <a name="section2.8">Командный файл powershell</a>

## <a name="section3">Вопросы и задания</a>
1.	Как с помощью графической оболочки Windows можно запретить доступ через определенный сетевой интерфейс к ресурсам используемого компьютера? Как можно запретить используемому компьютеру доступ к ресурсам других компьютеров в сети Microsoft?
> С помощью Брандмауэра (входящие) создаем правило блокировки для запрета доступа через определенный сетевой интерфейс.

> Для запрета доступа к ресурсам других компьютеров в сети Microsoft с помощью графической оболочки в панели управления -> "Центр управления сетями и общим доступом" -> "Изменение параметров адаптера" -> выбираем нужный адаптер, заходим в свойства -> отключаем службу доступа к файлам и принтерам Microsoft.  
2.	Опишите назначение команды net с директивами use, view, stop, start, share, config, session, user, statistics, localgroup. Приведите примеры.
> Команда net в операционных системах Windows используется для выполнения различных сетевых операций и административных задач. [!net](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/gg651155(v=ws.11))
* net use - используется для подключения или отключения ресурсов сети, таких как общие папки или принтеры.
Подключить общий ресурс
```
net use D: \\server\shared_folder
```
Отключить ресурс
```
net use D: /delete
```
* net view - позволяет просматривать список ресурсов и компьютеров в сети.
```powershell
PS C:\Windows\system32> net view
Имя сервера            Заметки

-------------------------------------------------------------------------------
\\CLEVER
Команда выполнена успешно.
```
* net stop и net start - используются для остановки и запуска службы Windows.
```powershell
PS C:\Windows\system32> NET STOP SPOOLER
Служба "Диспетчер печати" останавливается.
Служба "Диспетчер печати" успешно остановлена.

PS C:\Windows\system32> net start SPOOLER
Служба "Диспетчер печати" запускается.
Служба "Диспетчер печати" успешно запущена.
```
* net share - позволяет создавать, изменять или удалять общие ресурсы на компьютере.
* net config - показывает информацию о конфигурации сети, включая параметры аутентификации и рабочую группу
```powershell
PS C:\Windows\system32> net config workstation
Имя компьютера                                \\CLEVER
Полное имя компьютера                         clever
Имя пользователя                              fomidendy@gmail.com

Активная рабочая станция на
        NetBT_Tcpip_{3F9F4744-C517-4EB0-95C4-0FE5B32F0D01} (0A0027000008)

Версия программы                              Windows 10 Home Single Language

Домен рабочей станции                         WORKGROUP
Домен входа                                   MicrosoftAccount

Интервал ожидания открытия COM-порта (с)      0
Отсчет передачи COM-порта (байт)              16
Таймаут передачи COM-порта (мс)               250
Команда выполнена успешно.
```
* net session - позволяет просматривать активные сеансы пользователей на компьютере.
* net user - позволяет управлять учетными записями пользователей.
Создать нового пользователя
```
net user user2 123 /add
```
<img src="https://github.com/DeFomin/2023-2024-computer-networks-k33212-fomintsev-d-r/assets/90705279/ed295893-d4c9-4372-8c10-204f7cc20e0b" width=200>

* net statistics - показывает статистику сетевых протоколов и интерфейсов. 

```powershell
PS C:\Windows\system32> net statistics workstation
Статистика рабочей станции для \\CLEVER


Статистика после 20.09.2023 17:10:46


  Получено байт                              5378
  Принятые блоки сообщений сервера SMB       1
  Передано байт                              5289
  Переданные блоки сообщений сервера SMB     0
  Операции чтения                            0
  Операции записи                            0
  Отказано в чтении                          0
  Отказано в записи                          0

  Ошибки сети                                0
  Выполненные подключения                    0
  Повторные подключения                      0
  Отключений от сервера                      0

  Запущенные сеансы                          0
  Зависание сеансов                          0
  Сбои в сеансах                             0
  Сбои в операциях                           0
  Счетчик использования                      2
  Счетчик сбоев при использовании            0

Команда выполнена успешно.
```
* net localgroup - позволяет управлять локальными группами пользователей на компьютере.
```
net localgroup group1 user2 /add
```
3.	Как с помощью командной строки в Windows узнать адрес DNS, на который настроен ваш компьютер? 
```
ipconfig /all
```
Смотрим на Адаптер беспроводной локальной сети Беспроводная сеть
```Описание. . . . . . . . . . . . . : Intel(R) Wi-Fi 6E AX211 160MHz```
Видим ip адрес dns сервера
```DNS-серверы. . . . . . . . . . . : 192.168.3.1```

4.	Зачем нужна команда net use? Как с помощью этой утилиты подключить на локальный диск R: папку TEST на компьютере SRV (приведите командную строку)?
> Команда net use в операционных системах Windows используется для подключения сетевых ресурсов, таких как общие папки или принтеры.
Для подключения папки TEST с компьютера SRV на локальный диск R
```net use R: \\SRV\TEST```
5.	Как в Windows из PowerShell переименовать сетевое соединение?
Текущее имя сетевого соединения - ```Get-NetAdapter```
```powershell
Name                      InterfaceDescription                    ifIndex Status       MacAddress             LinkSpeed
----                      --------------------                    ------- ------       ----------             ---------
Беспроводная сеть         Intel(R) Wi-Fi 6E AX211 160MHz               19 Up           58-1C-F8-F0-4B-55       1.2 Gbps
Сетевое подключение Bl... Bluetooth Device (Personal Area Netw...      16 Disconnected 58-1C-F8-F0-4B-59         3 Mbps
Ethernet 2                VirtualBox Host-Only Ethernet Adapter         8 Up           0A-00-27-00-00-08         1 Gbps
```
Переименовать - ```Rename-NetAdapter -Name "Intel(R) Wi-Fi 6E AX211 160MHz " -NewName "MyWiFi"```

6.	Какие существуют и чем отличаются режимы работы адаптера (duplex) ?
Режим работы адаптера (duplex) определяет, как сетевой адаптер взаимодействует с другими устройствами в сети при передаче и приеме данных. 
1. Полудуплекс (Half Duplex)
В режиме полудуплекс адаптер может либо передавать данные, либо принимать их, но не одновременно.
3. Полнодуплекс (Full Duplex)
В режиме полнодуплекс адаптер может одновременно передавать и принимать данные, устройства могут работать в полнодуплексном режиме, не ожидая подтверждения передачи от других устройств. Полнодуплексное соединение более подходит для высоконагруженных сетей и обеспечивает более высокую производительность.

